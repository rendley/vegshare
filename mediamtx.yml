logLevel: info

api: yes
apiAddress: :9997

# HLS (HTTP) будет на порту 8888
hls: yes
hlsAddress: :8888

# WebRTC (WebSocket) будет на порту 8889
webrtc: yes
webrtcAddress: :8889
webrtcLocalUDPAddress: :8189
webrtcAllowOrigin: '*'

# RTMP для приема потока
rtmp: yes
rtmpAddress: :1935

# RTSP для приема потока
rtsp: yes
rtspAddress: :8554

paths:
  all:
    # Конфигурация для всех путей (пока пустая)

  # Основной поток (stream=0), принудительно транскодируем в H.264
  main_stream:
    runOnInit: >-
      ffmpeg -rtsp_transport tcp
      -i "rtsp://192.168.0.60:554/user=admin&password=zz123456&channel=1&stream=0.sdp"
      -c:v libx264 -profile:v baseline -pix_fmt yuv420p
      -c:a copy
      -f flv rtmp://localhost:1935/main_stream
    runOnInitRestart: yes

  # Дополнительный поток (stream=1), просто копируем (надеемся, что он H.264)
  sub_stream:
    runOnInit: >-
      ffmpeg -rtsp_transport tcp
      -i "rtsp://192.168.0.60:554/user=admin&password=zz123456&channel=1&stream=1.sdp"
      -c:v copy
      -c:a copy
      -f flv rtmp://localhost:1935/sub_stream
    runOnInitRestart: yes