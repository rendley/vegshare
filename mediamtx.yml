logLevel: info

api: yes
apiAddress: :9997

# HLS (HTTP) будет на порту 8888
hls: yes
hlsAddress: :8888

# WebRTC (WebSocket) будет на порту 8889
webrtc: yes
webrtcAddress: :8889
webrtcLocalUDPAddress: :8189
webrtcAllowOrigin: '*'

# RTMP для приема потока
rtmp: yes
rtmpAddress: :1935

# RTSP для приема потока
rtsp: yes
rtspAddress: :8554

paths:
  all:
    # Конфигурация для всех путей (пока пустая)

  local_cam:
    # Запускаем ffmpeg при старте mediamtx.
    # Эта команда забирает поток с камеры, полностью его перекодирует
    # для максимальной совместимости (как в вашем рабочем примере)
    # и публикует его в этот же самый путь (local_cam) по RTMP.
    runOnInit: >-
      ffmpeg -rtsp_transport tcp
      -i "rtsp://192.168.0.60:554/user=admin&password=zz123456&channel=1&stream=0.sdp"
      -c:v libx264 -profile:v baseline -pix_fmt yuv420p -bsf:v h264_mp4toannexb
      -c:a copy
      -f flv rtmp://localhost:1935/local_cam
    # Перезапускать ffmpeg, если он упадет.
    runOnInitRestart: yes
